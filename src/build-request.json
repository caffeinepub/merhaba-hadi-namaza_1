{
  "kind": "build_request",
  "title": "Fix prayer times display and restore Aladhan API integration",
  "projectName": "Namaz Vakitleri",
  "priority": "high",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "Restore Aladhan API integration for fetching prayer times, ensuring the backend proxy correctly calls the Aladhan API with method 13 for Turkish cities",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-1",
          "msg-3",
          "msg-5"
        ],
        "quotes": [
          "Haftalık Namaz Vakitleri Haftalık namaz vakitleri alınamadı SAATLİK NAMAZ VAKİTLERİ DE YOK",
          "daha önce sorunsuz çalışıyordu"
        ]
      },
      "acceptanceCriteria": [
        "Backend successfully fetches prayer times from Aladhan API",
        "API responses include all six daily prayer times (Imsak, Fajr, Sunrise, Dhuhr, Asr, Maghrib, Isha)",
        "Weekly prayer times endpoint returns 7 days of data"
      ]
    },
    {
      "id": "REQ-2",
      "text": "Fix prayer times display on the homepage to show daily and weekly prayer times without 'Haftalık namaz vakitleri alınamadı' error",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1",
          "msg-3"
        ],
        "quotes": [
          "Haftalık namaz vakitleri alınamadı SAATLİK NAMAZ VAKİTLERİ DE YOK",
          "Anasayfa da da var ramazan sekmesinde de var"
        ]
      },
      "acceptanceCriteria": [
        "Homepage displays current day's prayer times without errors",
        "Weekly prayer times table renders with all 7 days",
        "No 'alınamadı' (could not fetch) error messages appear"
      ]
    },
    {
      "id": "REQ-3",
      "text": "Fix prayer times display on the Ramazan (Ramadan) tab to show sahur and iftar times correctly",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1",
          "msg-3"
        ],
        "quotes": [
          "Anasayfa da da var ramazan sekmesinde de var",
          "daha önce sorunsuz çalışıyordu"
        ]
      },
      "acceptanceCriteria": [
        "Ramazan tab displays sahur (imsak) time",
        "Ramazan tab displays iftar (maghrib) time",
        "Countdown to next sahur or iftar works correctly"
      ]
    },
    {
      "id": "REQ-4",
      "text": "Implement persistent city selection using localStorage so the selected city is remembered across sessions and does not reset",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-3",
          "msg-4"
        ],
        "quotes": [
          "şehir manuel seçiliyor her seferinde değişiyor",
          "Şehir seçiminin her seferinde sıfırlanması yerine, kullanıcının son seçtiği şehrin hatırlanmasını ister misiniz? - Hatırlansın"
        ]
      },
      "acceptanceCriteria": [
        "User's last selected city is saved to localStorage",
        "On app reload, the saved city is automatically loaded",
        "City selection persists across browser sessions"
      ]
    },
    {
      "id": "REQ-5",
      "text": "Ensure hourly prayer time tracking displays correctly on the homepage",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "SAATLİK NAMAZ VAKİTLERİ DE YOK"
        ]
      },
      "acceptanceCriteria": [
        "Next prayer countdown shows hours and minutes remaining",
        "Current prayer slot is correctly identified",
        "Countdown updates every minute"
      ]
    }
  ],
  "constraints": [
    "Use Aladhan API with method 13 for Turkish cities",
    "Maintain existing multi-layer location storage architecture (IndexedDB, localStorage, sessionStorage)",
    "Keep all prayer time calculation logic in the frontend",
    "Preserve existing UI components in frontend/src/components/ui (read-only)",
    "Do not modify authentication hooks (useInternetIdentity.ts, useActor.ts)",
    "Backend must remain single-actor architecture in backend/main.mo"
  ],
  "nonGoals": [
    "Adding new prayer time APIs beyond Aladhan",
    "Changing the technology stack from React/Motoko",
    "Modifying the visual design or theme colors",
    "Adding real-time sync or WebSocket features",
    "Integrating third-party authentication beyond Internet Identity"
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}